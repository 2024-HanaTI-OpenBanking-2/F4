<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" th:href="@{/css/home.css}"/>
  <link rel="stylesheet" href="/css/global-style.css/">
  <link rel="stylesheet" href="/css/after_home-style.css/">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"/>
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
  <title>F4-afterlogin</title>
</head>
<body>
<div>
  <div class="element">
    <div class="div">
      <div class="overlap">
        <!-- Dynamic username display -->
        <a href="/">
          <div class="logo-img"><img src="img/fourfintech-logo.png" alt="FourFintech"></div>
        </a>
        <div class="swiper mySwiper">
          <div class="swiper-wrapper">
            <div class="swiper-slide swiper-container">
              <div class="swiper-content box-shadow-2">
                <p>계좌 조회</p>
                <div class="swiper-bank-content box-shadow">
                </div>
              </div>
            </div>
            <div class="swiper-slide swiper-container">
              <div class="swiper-content box-shadow-2">
                <p>카드 조회</p>
                <div class="swiper-bank-content box-shadow">
                </div>
              </div>
            </div>
            <div class="swiper-slide swiper-container">
              <div class="swiper-content box-shadow-2">
                <p>증권 조회</p>
                <div class="swiper-bank-content box-shadow">
                </div>
              </div>
            </div>
            <div class="swiper-slide swiper-container">
              <div class="swiper-content box-shadow-2">
                <p>보험 조회</p>
                <div class="swiper-bank-content box-shadow">
                </div>
              </div>
            </div>
          </div>
          <!-- Add Pagination -->
          <div class="swiper-pagination"></div>
          <!-- Add Navigation -->
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
        </div>
      </div>

      <img class="line" src="img/line-1.svg"/>
      <div class="overlap-4">
        <div class="overlap-group-wrapper">
          <div class="div-wrapper box-shadow">
            <!-- Logout link with Thymeleaf -->
            <div class="text-wrapper-9">
              <a class="logout" th:href="@{/logout}" th:text="'로그아웃'">Logout</a>
            </div>
          </div>
        </div>
      </div>
      <div class="button-title">
        <!--        <div class="customer-1" th:text="${customer.name} + '님의'"></div>-->
        <div class="customer-1">최준혁님의</div>
        <div class="customer-2">금융 정보</div>
      </div>
      <div class="menu_container">
        <div class="row-container">
          <div class="bank_container box-shadow" data-slide="0">은행<img src="img/piggy-bank.png"></div>
          <div class="card_container box-shadow" data-slide="1">카드<img src="img/atm-card.png"></div>
        </div>
        <div class="row-container">
          <div class="investment_container box-shadow" data-slide="2">증권<img src="img/financial-profit.png"></div>
          <div class="insurance_container box-shadow" data-slide="3">보험<img src="img/insurance.png"></div>
        </div>
      </div>
      <span class="search material-symbols-outlined">search</span>
      <span class="menu material-symbols-outlined">menu</span>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
<script src="/js/useopenbankingbutton.js"></script>
<script>
  var mySwiper = new Swiper('.mySwiper', {
    loop: true,
    // pagination: {
    //   el: '.swiper-pagination',
    //   clickable: true, // Pagination 클릭 가능
    //   // renderBullet: function (index, className) {
    //   //   return '<span class="' + className + '">' + (index + 1) + '</span>';
    //   // },
    // },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    mousewheel: true,
    keyboard: true,
    // autoplay: {
    //   delay: 2000,
    // },
  });

  // Add event listener to menu items
  document.querySelectorAll('.row-container div').forEach(function(item) {
    item.addEventListener('click', function() {
      var slideIndex = parseInt(this.getAttribute('data-slide'));
      mySwiper.slideToLoop(slideIndex, 500); // Swiper uses 1-based index for slideToLoop

      // 버튼 클릭 시 모션 추가
      document.querySelectorAll('.row-container div').forEach(function(elem) {
        elem.classList.remove('active');
      });
      item.classList.add('active');
    });
  });
</script>

<script>
  document.getElementById('authenticateLink').addEventListener('click', function (e) {
    e.preventDefault();
    var width = 700;
    var height = 700;
    var left = (screen.width / 2) - (width / 2);
    var top = (screen.height / 2) - (height / 2);
    var windowFeatures = `width=${width},height=${height},top=${top},left=${left},resizable=yes`;
    var popup = window.open('/show-send-form', 'Authenticate', windowFeatures);

    // 팝업 창이 닫혔는지 확인하는 함수
    var checkPopupClosed = setInterval(function() {
      if (popup && popup.closed) {
        clearInterval(checkPopupClosed);
        // 팝업이 닫혔을 때 처리할 작업을 여기에 작성
        // window.location.href = '/auth-code-page.html';
      }
    }, 500);
  });

  window.addEventListener("message", function (event) {
    if (event.data === "인증성공") {
      // 필요한 화면 업데이트 로직
      // location.reload();  // 예: 페이지 새로고침
      window.location.href = '/auth-code-page';
      // alert("인증이 완료되었습니다.");
      console.log("인증이 완료되었습니다.");
    }
  }, false);
</script>
</body>
</html>
